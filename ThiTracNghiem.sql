USE master
GO

CREATE DATABASE ThiTracNghiem
GO

USE ThiTracNghiem
GO

CREATE TABLE Lophoc
(
	MaLop CHAR PRIMARY KEY,
	TenLop CHAR
);
GO
CREATE TABLE MonHoc
(
	MaMH CHAR PRIMARY KEY,
	TenMH CHAR
);
GO
CREATE TABLE Chuong
(
	MaChuong CHAR PRIMARY KEY,
	TenChuong CHAR NOT NULL,
	MaMH CHAR,
	CONSTRAINT FK_Chuong_MonHoc FOREIGN KEY(MaMH)REFERENCES MonHoc(MaMH)
);
GO
CREATE TABLE TaiKhoan
(
	MaTK CHAR PRIMARY KEY,
	MatKhau CHAR NOT NULL,
	Email CHAR NOT NULL,
	LoaiTK CHAR(1) NOT NULL,
);
GO
CREATE TABLE ThongTinCB
(
	MaCB CHAR PRIMARY KEY,
	GioiTinh BIT NOT NULL,
	NgaySinh DATE NOT NULL,
	DiaChi NVARCHAR NOT NULL
	CONSTRAINT FK_ThongTinCB_TaiKhoan FOREIGN KEY(MaCB)REFERENCES TaiKhoan(MaTK)
);
GO
CREATE TABLE ThongTinSV
(
	MaSV CHAR PRIMARY KEY,
	GioiTinh BIT NOT NULL,
	NgaySinh DATE NOT NULL,
	DiaChi NVARCHAR NOT NULL,
	CONSTRAINT FK_ThongTinSV_TaiKhoan FOREIGN KEY(MaSV)REFERENCES TaiKhoan(MaTK)
);

GO
CREATE TABLE DanhSachLop
(
	MaSV CHAR,
	MaLop CHAR,
	PRIMARY KEY (MaSV,MaLop),
	CONSTRAINT FK_DanhSachLop_ThongTinSV FOREIGN KEY(MaSV)REFERENCES ThongTinSV(MaSV),
	CONSTRAINT FK_DanhSachLop_LopHoc FOREIGN KEY(MaLop)REFERENCES LopHoc(MaLop)
);
GO
CREATE TABLE Cauhoi
(
	MaCauHoi CHAR PRIMARY KEY,
	NoiDungCauHoi NVARCHAR NOT NULL,
	DapanA NVARCHAR NOT NULL,
	DapanB NVARCHAR NOT NULL,
	DapanC NVARCHAR NOT NULL,
	DapanD NVARCHAR NOT NULL,
	DapanDung CHAR(1) NOT NULL,
	MaChuong CHAR,
	CONSTRAINT FK_CauHoi_Chuong FOREIGN KEY(MaChuong)REFERENCES Chuong(MaChuong)
);
CREATE TABLE DeThi
(
	MaDeThi CHAR PRIMARY KEY,
	TenDeThi NVARCHAR NOT NULL,
	TGlambai TIME NOT NULL,
	SoLuongCau INT NOT NULL,
	NoiDungDeThi VARCHAR NOT NULL,
	MaCB CHAR,
	MaLop CHAR,
	MaMH CHAR,
	CONSTRAINT FK_DeThi_ThongTinCB FOREIGN KEY(MaCB)REFERENCES ThongTinCB(MaCB),
	CONSTRAINT FK_DeThi_LopHoc FOREIGN KEY(MaLop)REFERENCES LopHoc(MaLop),
	CONSTRAINT FK_DeThi_MonHoc FOREIGN KEY(MaMH)REFERENCES MonHoc(MaMH)
);
CREATE TABLE BaiLam
(
	MaBaiLam CHAR,
	MaSV CHAR,
	DapanDaChon NVARCHAR,
	TrangThai BIT NOT NULL,
	PRIMARY KEY (MaBaiLam, MaSV),
	CONSTRAINT FK_BaiLam_DeThi FOREIGN KEY(MaBaiLam)REFERENCES DeThi(MaDeThi),
	CONSTRAINT FK_BaiLam_ThongTinSV FOREIGN KEY(MaSV)REFERENCES ThongTinSV(MaSV)
);
--DROP DATABASE ThiTracNghiem